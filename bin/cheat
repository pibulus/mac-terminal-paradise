#!/bin/bash
# Pablo's Ultimate Interactive Terminal Cheatsheet
# Save this as ~/bin/cheat and chmod +x it

# Colors
CYAN='\033[0;36m'
YELLOW='\033[1;33m'
GREEN='\033[0;32m'
PURPLE='\033[0;35m'
RED='\033[0;31m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# Track if user is new
FIRST_RUN_FILE="$HOME/.cheat_welcomed"

# Welcome screen for first run
show_welcome() {
    if [ ! -f "$FIRST_RUN_FILE" ]; then
        clear
        echo -e "${CYAN}"
        figlet "Welcome!" | lolcat
        echo -e "${NC}"
        
        gum style \
            --border double \
            --border-foreground 212 \
            --padding "1 2" \
            --margin "1" \
            --align center \
            "ğŸ‰ WELCOME TO YOUR TERMINAL SUPERPOWER GUIDE! ğŸ‰

This interactive guide will teach you everything about
your amazing terminal setup. Let's start with a quick tour!"
        
        echo ""
        if gum confirm "Ready for the tour?"; then
            show_quick_tour
        fi
        touch "$FIRST_RUN_FILE"
    fi
}

# Quick tour for new users
show_quick_tour() {
    clear
    gum style \
        --border rounded \
        --border-foreground 99 \
        --padding "1 2" \
        "ğŸš€ QUICK TOUR - 5 ESSENTIAL COMMANDS

1. z [folder] â†’ Jump to ANY folder instantly
   Try: z down â†’ Goes to Downloads!

2. Cmd+\` â†’ Summon terminal from ANYWHERE
   This is your new superpower!

3. lazygit â†’ Visual git (in any git folder)
   Never type git commands again!

4. fzf â†’ Find ANYTHING instantly
   Ctrl+R for history, Ctrl+T for files

5. btop â†’ Beautiful system monitor
   Press 'p' to change themes!"
    
    echo ""
    gum input --placeholder "Press enter to continue..."
}

# Main menu function
show_menu() {
    clear
    echo -e "${CYAN}"
    figlet "Cheat Menu" | lolcat
    echo -e "${NC}"
    
    CHOICE=$(gum choose \
        "ğŸ® Ghostty Shortcuts" \
        "âš¡ Custom Keybindings (Your Secret Weapons)" \
        "ğŸ¹ TMUX-Style Commands (Cmd+B)" \
        "ğŸ“ File Navigation" \
        "ğŸ¨ Fun & Visual Commands" \
        "ğŸ”¥ Git Commands" \
        "ğŸ› ï¸ System Monitoring" \
        "ğŸ–¼ï¸ Image & Media Tools" \
        "âŒ¨ï¸ Terminal Shortcuts" \
        "ğŸŒŸ Modern CLI Tools (Your Replacements)" \
        "ğŸ“ Functions & Aliases" \
        "ğŸ¯ Interactive Tutorials" \
        "ğŸ” Search Everything" \
        "ğŸ“š Full Cheatsheet" \
        "ğŸŒˆ Show Me Something Cool" \
        "ğŸ’¡ Daily Power Tip" \
        "âŒ Exit")
    
    case "$CHOICE" in
        "ğŸ® Ghostty Shortcuts")
            show_ghostty_shortcuts
            ;;
        "âš¡ Custom Keybindings (Your Secret Weapons)")
            show_custom_keybindings
            ;;
        "ğŸ¹ TMUX-Style Commands (Cmd+B)")
            show_tmux_commands
            ;;
        "ğŸ“ File Navigation")
            show_file_navigation
            ;;
        "ğŸ¨ Fun & Visual Commands")
            show_fun_commands
            ;;
        "ğŸ”¥ Git Commands")
            show_git_commands
            ;;
        "ğŸ› ï¸ System Monitoring")
            show_system_tools
            ;;
        "ğŸ–¼ï¸ Image & Media Tools")
            show_image_tools
            ;;
        "âŒ¨ï¸ Terminal Shortcuts")
            show_terminal_shortcuts
            ;;
        "ğŸŒŸ Modern CLI Tools (Your Replacements)")
            show_modern_tools
            ;;
        "ğŸ“ Functions & Aliases")
            show_functions_aliases
            ;;
        "ğŸ¯ Interactive Tutorials")
            show_tutorials_menu
            ;;
        "ğŸ” Search Everything")
            show_search_menu
            ;;
        "ğŸ“š Full Cheatsheet")
            glow ~/terminal-cheatsheet.md | less
            ;;
        "ğŸŒˆ Show Me Something Cool")
            show_something_cool
            ;;
        "ğŸ’¡ Daily Power Tip")
            show_power_tip
            ;;
        "âŒ Exit")
            echo "Remember: type 'cheat' anytime to come back! ğŸ‘‹"
            exit 0
            ;;
    esac
    
    echo ""
    gum confirm "Back to menu?" && show_menu
}

# NEW: Custom keybindings section
show_custom_keybindings() {
    gum style \
        --border double \
        --border-foreground 212 \
        --padding "1 2" \
        --margin "1" \
        "âš¡ YOUR CUSTOM KEYBINDINGS - SECRET WEAPONS!

ğŸ” SEARCH & EDIT
Ctrl+F  â†’ Find file & edit it instantly!
Ctrl+T  â†’ FZF file search
Ctrl+R  â†’ Search command history (fuzzy!)
Alt+C   â†’ Change directory with preview

ğŸ“ GIT INTEGRATION  
Ctrl+G  â†’ Interactive git status
         (select files, see diffs!)

ğŸš€ QUICK ACTIONS
Ctrl+P  â†’ Find & kill processes
Alt+D   â†’ Jump to recent directories (zi)
ESC ESC â†’ Add 'sudo' to command!

ğŸ’¡ HISTORY MAGIC
â†‘/â†“     â†’ Search history by what you typed
         (type 'git' then â†‘ for git commands!)

âš ï¸  THESE ARE YOUR UNIQUE POWERS!
Most people don't have these - you do!"
    
    echo ""
    if gum confirm "Want to try Ctrl+F now?"; then
        echo "Press Ctrl+F to find and edit a file!"
        read -n 1
    fi
}

# NEW: Modern tools section
show_modern_tools() {
    gum style \
        --border double \
        --border-foreground 87 \
        --padding "1 2" \
        --margin "1" \
        "ğŸŒŸ YOUR MODERN CLI REPLACEMENTS

OLD â†’ NEW (What you have!)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
cat   â†’ bat      (syntax highlighting!)
ls    â†’ eza      (icons + git status!)
find  â†’ fd       (5x faster!)
grep  â†’ rg       (ripgrep - blazing fast!)
cd    â†’ z        (smart jumps!)
top   â†’ btop     (beautiful graphs!)
htop  â†’ btop     (even better!)
ps    â†’ procs    (intuitive output!)
du    â†’ dust     (visual disk usage!)
df    â†’ duf      (disk usage that makes sense!)
man   â†’ tldr     (examples first!)
diff  â†’ delta    (side-by-side diffs!)
dig   â†’ dog      (colorful DNS!)
ping  â†’ gping    (graph your ping!)

ğŸ¯ QUICK TEST
Try these NOW to see the difference:
â€¢ ls vs eza --icons
â€¢ cat file vs bat file
â€¢ ps vs procs"
    
    echo ""
    DEMO=$(gum choose "Compare ls vs eza" "Compare cat vs bat" "Compare ps vs procs" "Skip demo")
    case "$DEMO" in
        "Compare ls vs eza")
            echo -e "${YELLOW}Old ls:${NC}"
            ls -la | head -10
            echo -e "\n${GREEN}Your eza:${NC}"
            eza -la --icons | head -10
            gum input --placeholder "See the difference? Press enter..."
            ;;
        "Compare cat vs bat")
            echo "cat ~/.zshrc:" 
            cat ~/.zshrc | head -20
            echo -e "\n${GREEN}bat ~/.zshrc:${NC}"
            bat ~/.zshrc --line-range=1:20
            ;;
        "Compare ps vs procs")
            echo -e "${YELLOW}Old ps:${NC}"
            ps aux | head -10
            echo -e "\n${GREEN}Your procs:${NC}"
            procs | head -10
            ;;
    esac
}

# NEW: Functions and aliases section
show_functions_aliases() {
    gum style \
        --border double \
        --border-foreground 214 \
        --padding "1 2" \
        --margin "1" \
        "ğŸ“ YOUR CUSTOM FUNCTIONS & ALIASES

ğŸš€ QUICK SHORTCUTS
reload    â†’ Reload your terminal config
zshrc     â†’ Edit your .zshrc
mkcd      â†’ Make directory AND enter it
backup    â†’ Backup file with timestamp
extract   â†’ Extract ANY archive type
ginit     â†’ Start git repo with .gitignore
targz     â†’ Create tar.gz archive
note      â†’ Add a quick note
notes     â†’ View all your notes
weather   â†’ Get weather (weather Tokyo)
cht       â†’ Cheatsheet for any command

ğŸ“‚ SMART NAVIGATION  
..        â†’ cd ..
...       â†’ cd ../..
-         â†’ cd to previous directory
~         â†’ cd to home

ğŸŒ NETWORK
myip      â†’ Your public IP
localip   â†’ Your local IP  
ports     â†’ Show listening ports
serve     â†’ Start Python web server
speedtest â†’ Test internet speed

ğŸ’¡ TRY THIS
Type 'mkcd test-folder' - it creates AND enters!"
    
    echo ""
    if gum confirm "Try mkcd now?"; then
        FOLDER=$(gum input --placeholder "Folder name to create...")
        if [ -n "$FOLDER" ]; then
            mkcd "$FOLDER"
            echo "You're now in: $(pwd)"
            echo "Type 'cd -' to go back!"
            gum input --placeholder "Press enter..."
        fi
    fi
}

# NEW: Interactive tutorials menu
show_tutorials_menu() {
    TUTORIAL=$(gum choose \
        "ğŸš€ Master FZF (Fuzzy Finding)" \
        "ğŸ“ Master Zoxide (Smart CD)" \
        "ğŸ¨ Master Eza (Beautiful LS)" \
        "ğŸ”¥ Master Lazygit" \
        "âš¡ Master Terminal Navigation" \
        "ğŸ¯ Build a Quick Workflow" \
        "Back to menu")
    
    case "$TUTORIAL" in
        "ğŸš€ Master FZF (Fuzzy Finding)")
            tutorial_fzf
            ;;
        "ğŸ“ Master Zoxide (Smart CD)")
            tutorial_zoxide
            ;;
        "ğŸ¨ Master Eza (Beautiful LS)")
            tutorial_eza
            ;;
        "ğŸ”¥ Master Lazygit")
            tutorial_lazygit
            ;;
        "âš¡ Master Terminal Navigation")
            tutorial_navigation
            ;;
        "ğŸ¯ Build a Quick Workflow")
            tutorial_workflow
            ;;
    esac
}

# FZF Tutorial
tutorial_fzf() {
    clear
    gum style \
        --border rounded \
        --border-foreground 99 \
        --padding "1 2" \
        "ğŸš€ FZF MASTERY COURSE

FZF = Fuzzy Finder = Find ANYTHING instantly!

LESSON 1: Basic FZF"
    
    echo ""
    gum confirm "Ready to try fzf?" && {
        echo "Type 'fzf' and press enter. Type to filter, arrows to select, enter to choose:"
        fzf
    }
    
    echo ""
    gum style \
        --border rounded \
        --border-foreground 99 \
        --padding "1 2" \
        "LESSON 2: Power Shortcuts

Ctrl+T â†’ Find any file (with preview!)
Ctrl+R â†’ Search ALL your command history
Alt+C  â†’ cd to any directory

TRY IT: Press Ctrl+R right now!"
    
    gum input --placeholder "Try Ctrl+R, then press enter to continue..."
    
    gum style \
        --border rounded \
        --border-foreground 99 \
        --padding "1 2" \
        "LESSON 3: Advanced FZF

# Find and edit files
vim \$(fzf)

# Kill processes interactively  
kill -9 \$(ps aux | fzf | awk '{print \$2}')

# Git branch switching
git checkout \$(git branch | fzf)

# Search file contents
rg --files | fzf --preview 'bat {}'"
    
    echo ""
    gum input --placeholder "You're now an FZF master! Press enter..."
}

# Zoxide tutorial
tutorial_zoxide() {
    clear
    gum style \
        --border rounded \
        --border-foreground 214 \
        --padding "1 2" \
        "ğŸ“ ZOXIDE MASTERY - CD ON STEROIDS!

Zoxide learns your habits and lets you jump anywhere!

LESSON 1: Basic Usage
Instead of: cd ~/Documents/Projects/my-app
Just type:  z my-app

Instead of: cd ../../../Downloads
Just type:  z down"
    
    echo ""
    echo "Your most visited directories:"
    zoxide query -l | head -10
    
    echo ""
    gum confirm "Want to see interactive mode?" && {
        echo "Type 'zi' for interactive selection:"
        echo "(Press Ctrl+C if you want to cancel)"
        zi
    }
    
    gum style \
        --border rounded \
        --border-foreground 214 \
        --padding "1 2" \
        "ADVANCED TIPS:

z foo       â†’ Jump to best match with 'foo'
z foo bar   â†’ Jump to best match with 'foo' AND 'bar'
zi          â†’ Interactive selection
z -         â†’ Go back to previous directory

POWER MOVE: Combine with fzf!
z \$(fd -t d | fzf)  â†’ Choose from ALL directories!"
}

# Search menu
show_search_menu() {
    SEARCH_TYPE=$(gum choose \
        "ğŸ“„ Search in files (ripgrep)" \
        "ğŸ“ Search filenames (fd)" \
        "ğŸ“š Search cheatsheet" \
        "ğŸ”™ Back")
    
    case "$SEARCH_TYPE" in
        "ğŸ“„ Search in files (ripgrep)")
            PATTERN=$(gum input --placeholder "Search pattern...")
            if [ -n "$PATTERN" ]; then
                echo "Searching for '$PATTERN'..."
                rg "$PATTERN" --color=always | head -20
            fi
            ;;
        "ğŸ“ Search filenames (fd)")
            PATTERN=$(gum input --placeholder "Filename pattern...")
            if [ -n "$PATTERN" ]; then
                fd "$PATTERN" --color=always | head -20
            fi
            ;;
        "ğŸ“š Search cheatsheet")
            search_cheatsheet
            ;;
    esac
    gum input --placeholder "Press enter to continue..."
}

# Power tip of the day
show_power_tip() {
    TIPS=(
        "ğŸš€ TIP: Press 'v' in lazygit to edit files directly!"
        "âš¡ TIP: Type '!!' to run your last command again!"
        "ğŸ¯ TIP: Use 'Alt+.' to insert the last argument from previous command!"
        "ğŸ’¡ TIP: Type 'fuck' after a failed command to fix it!"
        "ğŸ”¥ TIP: In fzf, use 'Ctrl+/' to toggle preview window!"
        "ğŸ“ TIP: Type '-' to go back to previous directory!"
        "ğŸ¨ TIP: Run 'btop' and press 'p' to cycle through themes!"
        "âŒ¨ï¸ TIP: Start typing and press â†’ to accept autosuggestion!"
        "ğŸŒŸ TIP: Use 'gw' to switch between git worktrees!"
        "ğŸ“Š TIP: Run 'duf' for beautiful disk usage info!"
        "ğŸ” TIP: Use 'tldr <command>' for quick examples!"
        "ğŸš€ TIP: Press Ctrl+G for interactive git status!"
        "ğŸ’¾ TIP: Use 'backup <file>' to create timestamped backup!"
        "ğŸ¯ TIP: Type 'zi' for interactive directory jumping!"
        "âš¡ TIP: Double-tap ESC to add 'sudo' to your command!"
    )
    
    # Show a random tip with style
    TIP="${TIPS[$RANDOM % ${#TIPS[@]}]}"
    
    clear
    echo -e "${CYAN}"
    figlet "Power Tip!" | lolcat
    echo -e "${NC}"
    
    gum style \
        --border double \
        --border-foreground 212 \
        --padding "2 4" \
        --margin "1" \
        --align center \
        "$TIP"
    
    echo ""
    echo "Want to try it? Go ahead!"
    gum input --placeholder "Press enter for another tip..." && show_power_tip
}

# Enhanced git commands
show_git_commands() {
    gum style \
        --border double \
        --border-foreground 208 \
        --padding "1 2" \
        --margin "1" \
        "ğŸ”¥ GIT COMMAND MASTERY

ğŸ¯ VISUAL TOOLS (Recommended!)
lazygit       â†’ Full git UI (BEST!)
tig           â†’ Alternative git UI
gitui         â†’ Another great option

âš¡ YOUR SHORTCUTS
gs   â†’ git status        gp   â†’ git push
ga   â†’ git add          gpl  â†’ git pull  
gaa  â†’ git add .        gco  â†’ git checkout
gc   â†’ git commit       gb   â†’ git branch
gcm  â†’ git commit -m    glog â†’ pretty git log
gdiff â†’ git diff (colored)
gw   â†’ switch git worktrees (NEW!)

ğŸš€ POWER COMMANDS
ginit         â†’ Initialize repo with .gitignore
git add -p    â†’ Stage specific parts
git bisect    â†’ Find bug introductions
git stash     â†’ Save work temporarily
git reflog    â†’ Undo ANYTHING

ğŸ’¡ WORKFLOW TIPS
1. Use lazygit for everything!
2. Press Ctrl+G for quick status
3. Use 'gw' for worktree switching"
    
    echo ""
    if gum confirm "Open lazygit tutorial?"; then
        tutorial_lazygit
    fi
}

# Lazygit tutorial
tutorial_lazygit() {
    clear
    gum style \
        --border rounded \
        --border-foreground 208 \
        --padding "1 2" \
        "ğŸ”¥ LAZYGIT QUICK TUTORIAL

MAIN PANELS:
â€¢ Status (top left)
â€¢ Files (left)
â€¢ Diff (right)
â€¢ Commands (bottom)

KEY SHORTCUTS:
Space  â†’ Stage/unstage file
c      â†’ Commit
p      â†’ Push
P      â†’ Pull
b      â†’ Branches
s      â†’ Stash
?      â†’ Help (IMPORTANT!)

POWER MOVES:
a      â†’ Stage all
d      â†’ Delete/discard
e      â†’ Edit file
v      â†’ Open in editor
x      â†’ Open menu
]      â†’ Next tab
[      â†’ Previous tab"
    
    echo ""
    if [ -d .git ]; then
        gum confirm "This is a git repo! Open lazygit?" && lazygit
    else
        echo "Not in a git repo. Navigate to one and type 'lazygit'!"
    fi
}

# Enhanced fun commands with more demos
show_fun_commands() {
    gum style \
        --border double \
        --border-foreground 205 \
        --padding "1 2" \
        --margin "1" \
        "ğŸ¨ FUN & VISUAL COMMANDS

ğŸŒˆ VISUAL EFFECTS
cmatrix       â†’ Matrix rain
pipes-sh      â†’ Animated pipes
rain          â†’ Rain effect
asciiquarium  â†’ Fish tank
sl            â†’ Choo choo train!
neko          â†’ Cat follows cursor
cava          â†’ Audio visualizer
tty-clock -c  â†’ Digital clock

ğŸ­ TEXT ART
figlet text   â†’ Big ASCII text
toilet text   â†’ Colorful ASCII
cowsay text   â†’ Cow speaks
ponysay text  â†’ Pony speaks
fortune       â†’ Random quotes
lolcat        â†’ Rainbowify text

ğŸ“Š SYSTEM BEAUTY
neofetch      â†’ System + ASCII logo
pfetch        â†’ Minimal version
btop          â†’ Beautiful monitoring

ğŸ® COMBINATIONS
fortune | cowsay | lolcat
figlet PABLO | lolcat
echo 'Hello' | toilet -f mono12 | lolcat"
    
    echo ""
    DEMO=$(gum choose \
        "ğŸŒ§ï¸ Matrix Rain" \
        "ğŸ  Aquarium" \
        "ğŸš‚ Punishment Train" \
        "ğŸ¨ Text Art Combo" \
        "ğŸŒˆ Rainbow Fortune" \
        "ğŸ’» System Info" \
        "ğŸµ Audio Visualizer" \
        "Skip demos")
    
    case "$DEMO" in
        "ğŸŒ§ï¸ Matrix Rain")
            timeout 5s cmatrix -b -C cyan
            ;;
        "ğŸ  Aquarium")
            timeout 10s asciiquarium
            ;;
        "ğŸš‚ Punishment Train")
            sl
            ;;
        "ğŸ¨ Text Art Combo")
            echo "PABLO" | figlet | lolcat
            echo "IS" | toilet -f mono12 | lolcat
            echo "AWESOME" | cowsay | lolcat
            ;;
        "ğŸŒˆ Rainbow Fortune")
            fortune | ponysay | lolcat
            ;;
        "ğŸ’» System Info")
            neofetch
            ;;
        "ğŸµ Audio Visualizer")
            echo "Play some music and watch!"
            timeout 10s cava
            ;;
    esac
    gum input --placeholder "Press enter to continue..."
}

# Workflow tutorial
tutorial_workflow() {
    clear
    gum style \
        --border rounded \
        --border-foreground 212 \
        --padding "1 2" \
        "ğŸ¯ BUILD YOUR POWER WORKFLOW

Let's combine everything you've learned!

SCENARIO: Starting a new project"
    
    echo ""
    gum confirm "Ready to see a pro workflow?" && {
        echo -e "${GREEN}Step 1: Create and enter directory${NC}"
        echo "$ mkcd my-awesome-project"
        
        echo -e "\n${GREEN}Step 2: Initialize git${NC}"
        echo "$ ginit"
        
        echo -e "\n${GREEN}Step 3: Create some files${NC}"
        echo "$ touch README.md index.js"
        
        echo -e "\n${GREEN}Step 4: Open in editor (Ctrl+F to find files)${NC}"
        echo "$ code ."
        
        echo -e "\n${GREEN}Step 5: Use lazygit for version control${NC}"
        echo "$ lazygit"
        
        echo -e "\n${GREEN}Step 6: Quick commit${NC}"
        echo "$ gcm 'Initial commit'"
        
        echo -e "\n${GREEN}Step 7: Jump back anytime${NC}"
        echo "$ z awesome"
    }
    
    gum input --placeholder "You're ready! Press enter..."
}

# Ghostty shortcuts (updated)
show_ghostty_shortcuts() {
    gum style \
        --border double \
        --border-foreground 212 \
        --padding "1 2" \
        --margin "1" \
        "ğŸ® GHOSTTY SHORTCUTS - COMPLETE GUIDE

ğŸš€ QUICK TERMINAL
Cmd+\`         â†’ Toggle quick terminal (ANYWHERE!)
                 This is your #1 superpower!

ğŸ“ SPLITS & TABS
Cmd+D         â†’ Split right
Cmd+Shift+D   â†’ Split down
Cmd+T         â†’ New tab
Cmd+W         â†’ Close current
Cmd+[1-9]     â†’ Jump to tab
Cmd+Shift+[/] â†’ Previous/next tab

ğŸ¯ NAVIGATION
Cmd+â†/â†’/â†‘/â†“   â†’ Navigate splits
Cmd+H/J/K/L   â†’ Navigate (vim style) [NEW!]
Mouse hover   â†’ Focus follows mouse!
Cmd+Shift+Z   â†’ Zoom/unzoom split
Cmd+Shift+E   â†’ Equalize splits

âš™ï¸ CONTROLS
Cmd+K         â†’ Clear screen
Cmd+R         â†’ Reload config instantly
Cmd+Plus/Min  â†’ Zoom in/out
Cmd+0         â†’ Reset zoom
Cmd+F         â†’ Find in terminal
Cmd+G/Shift+G â†’ Find next/previous
Cmd+I         â†’ Inspector (debug)

ğŸ¨ APPEARANCE
Cmd+Shift+F   â†’ Fullscreen
Your theme    â†’ UltraViolent (sick!)
Your font     â†’ JetBrains Mono"
    
    echo ""
    if gum confirm "Test quick terminal? (Press Cmd+\` after)"; then
        echo "Minimize this window, then press Cmd+\` from any app!"
        echo "It's your instant terminal from anywhere!"
        gum input --placeholder "Press enter when you've tried it..."
    fi
}

# Start with welcome if first run
show_welcome

# Start the menu
show_menu